# mini-framework

## üöÄ Pr√©sentation

**mini-framework** est un micro-framework JavaScript qui vous permet de cr√©er des applications web modernes en toute simplicit√©, sans d√©pendre de biblioth√®ques externes comme React, Vue ou Angular. Il propose :

- Une abstraction du DOM via un Virtual DOM
- Un syst√®me de routage simple
- Une gestion d'√©tat globale
- Un syst√®me d'√©v√©nements custom

---

## üß© Fonctionnalit√©s principales

- **Abstraction du DOM** : Manipulez l'interface utilisateur via des objets JS (Virtual DOM), puis synchronisez efficacement avec le DOM r√©el.
- **Routage** : Synchronisez l'URL et l'affichage de vos composants/pages avec support navigation navigateur.
- **Gestion d'√©tat** : Stockez et partagez l'√©tat de l'application entre tous vos composants avec re-rendu automatique.
- **Gestion d'√©v√©nements** : Attachez des √©v√©nements de fa√ßon d√©clarative, sans `addEventListener`.
- **Lifecycle des composants** : M√©thodes `Mounting()` et `UnMounting()` pour g√©rer le cycle de vie.
- **R√©f√©rences DOM** : Syst√®me de r√©f√©rences pour acc√©der directement aux √©l√©ments DOM.

---

## üì¶ Structure du projet

```
mini-framework/
‚îú‚îÄ‚îÄ framework/
‚îÇ   ‚îú‚îÄ‚îÄ component.js      # Classe de base pour vos composants
‚îÇ   ‚îú‚îÄ‚îÄ framwork.js       # Classe principale du framework (routing, state, etc.)
‚îÇ   ‚îî‚îÄ‚îÄ helpers.js        # Fonctions utilitaires (Virtual DOM, diff, etc.)
‚îú‚îÄ‚îÄ todoMVC/              # Application TodoMVC compl√®te en exemple
‚îÇ   ‚îú‚îÄ‚îÄ index.html
‚îÇ   ‚îú‚îÄ‚îÄ style.css
‚îÇ   ‚îî‚îÄ‚îÄ app.js
‚îú‚îÄ‚îÄ index.html            # Page de d√©monstration
‚îú‚îÄ‚îÄ main.js               # Exemples d'utilisation du framework
‚îú‚îÄ‚îÄ README.md             # Ce fichier
‚îî‚îÄ‚îÄ INSTRUCTION.md        # Cahier des charges
```

---

## üõ†Ô∏è Utilisation rapide

### 1. Installation

Clonez ou t√©l√©chargez le repository et naviguez dans le dossier.

```bash
git clone <your-repo>
cd mini-framework
```

### 2. Test rapide

Ouvrez `index.html` dans votre navigateur pour voir la d√©monstration, ou lancez un serveur local :

```bash
# Avec Python
python -m http.server 8000

# Avec Node.js (si vous avez npx)
npx serve .
```

Note:

- La version `todoMVC` utilise `localStorage` (cl√© `miniframework_todos_v1`) pour persister les todos entre rechargements.
- Le `Dashboard` de la d√©mo principale lit les todos du state global et affiche des statistiques calcul√©es (total, actifs, compl√©t√©s, %).

Puis visitez `http://localhost:8000`

## üõ°Ô∏è Notes pour l'audit

- **Routage** : le framework utilise le mode _hash routing_ (via `location.hash`). Cela √©vite les 404 lors du rafra√Æchissement sur un serveur statique simple.
- **V√©rifications TodoMVC** : pour valider la conformit√©, v√©rifiez que l'exemple TodoMVC (dans `todoMVC/` ou `main.js`) contient :
  - un champ d'ajout de todo (input) et un bouton/contr√¥le pour ajouter une t√¢che;
  - chaque t√¢che rendue avec la classe `todo-item` (ou √©quivalent clairement identifiable);
  - un √©l√©ment `footer` (ou tout √©l√©ment avec la classe `footer`) visible lorsque la liste contient au moins une t√¢che;
  - contr√¥les de filtrage (All / Active / Completed) qui filtrent l'affichage et mettent √©ventuellement √† jour l'URL/hash;
  - un bouton `Clear completed` qui supprime uniquement les t√¢ches compl√©t√©es;
  - persistance via `localStorage` (cl√© utilis√©e : `miniframework_todos_v1`).

Pour v√©rifier rapidement : ouvrir `http://localhost:8000`, aller sur la route Todo, ajouter quelques todos, tester cocher/d√©cocher, filtrer et cliquer sur Clear Completed. Il ne doit pas y avoir d'erreurs dans la console DevTools.

## ‚úÖ Audit ‚Äî Q&A

- **VDOM :** impl√©mentation dans `framework/helpers.js` ‚Äî fonctions cl√©s : `createVElement`, `VDomToReelDom`, `diff`, `updateDOM`. V√©rifier : modification d'un composant provoque un patch minimal sur le DOM (inspecter √©l√©ments et classes en DevTools).

- **Routage :** impl√©mentation dans `framework/framwork.js` ‚Äî fonctions : `getCurrentPath()`, `navigateTo(path)` et √©couteur `hashchange`. V√©rifier : changement d'URL via `app.navigateTo('/path')` met √† jour le hash et le composant affich√© ; rafra√Æchir la page ne doit pas renvoyer 404 sur un serveur statique.

- **Gestion d'√©tat :** impl√©mentation dans `framework/framwork.js` ‚Äî API : `getState(name)`, `setState(name, value)`, `setWState(name, value)`. V√©rifier : `setState` d√©clenche re-render, `setWState` ne d√©clenche pas de re-render.

- **√âv√©nements et nettoyage :** modifications appliqu√©es dans `framework/helpers.js` ‚Äî m√©canisme : `listenerMap` (WeakMap), utilitaires `addListener()` / `removeListener()` et int√©gration dans `updateProps`/`setProp`. V√©rifier : naviguer entre pages et observer absence de doublons d'√©couteurs (console, profiler, ou instrumentation simple `console.count()` dans un handler).

- **Persistance TodoMVC :** l'exemple utilise `localStorage` avec la cl√© `miniframework_todos_v1` (voir `todoMVC/` ou la logique dans `main.js` / `TodoDemoComponent`). V√©rifier : ajouter des todos, recharger la page, les todos persistent.

- **Tests manuels rapides :**
  - D√©marrer le serveur :
    ```bash
    python3 -m http.server 8000
    ```
  - V√©rifier l'√©coute : `ss -ltnp 'sport = :8000'` ou `lsof -i :8000`
  - V√©rifier la r√©ponse HTTP : `curl -I http://localhost:8000/`
  - Ouvrir `http://localhost:8000/` puis naviguer vers la route Todo et ex√©cuter la checklist TodoMVC (ajout, √©dition, bascule, filtres, Clear completed).

- **Emplacement des √©l√©ments √† relire pour l'audit :**
  - VDOM & events : `framework/helpers.js`
  - Framework (routing/state/ref) : `framework/framwork.js`
  - Composants de base : `framework/component.js`
  - D√©mo Todo et persistance : `todoMVC/` et `main.js`

- **Commit attendu pour la correction √©v√©nements :** si n√©cessaire, rechercher le commit `fix(events): dedupe listeners and deterministic cleanup` sur la branche `component` ou v√©rifier le fichier `framework/helpers.js` dans l'arborescence de travail.

Si vous voulez, je peux :
- committer/pusher la modification `README.md` (message propos√© : `docs(audit): add Q&A and verification steps`),
- ou lancer les v√©rifications manuelles et rapporter les observations.

### 3. Projet TodoMVC

Pour voir l'exemple TodoMVC conforme aux sp√©cifications officielles :

```bash
cd todoMVC
# Ouvrez index.html ou lancez un serveur dans ce dossier
```

### 4. Cr√©ez votre propre application

Pr√©parez votre HTML :

```html
<!DOCTYPE html>
<html>
  <head>
    <title>Mon App</title>
  </head>
  <body>
    <div id="app"></div>
    <script type="module" src="main.js"></script>
  </body>
</html>
```

Cr√©ez votre application :

```js
// main.js
import { Framework } from "./framework/framwork.js";
import { Component } from "./framework/component.js";

class HelloComponent extends Component {
  getVDom() {
    return this.framework.createVElement("h1", {}, ["Hello World!"]);
  }
}

const app = new Framework();
app.route("/", HelloComponent);
app.start();
```

---

## ‚öôÔ∏è API du framework

### Classe `Framework`

#### Constructeur

```js
const app = new Framework((initialState = {}));
```

#### M√©thodes de routage

- `route(path, ComponentClass)` : Associe un chemin √† un composant
- `navigateTo(path)` : Change l'URL et affiche le composant associ√©
- `start()` : D√©marre l'application (affiche la page courante)

#### Gestion d'√©tat

- `setState(name, value)` : Modifie l'√©tat global et re-render automatiquement
- `getState(name)` : R√©cup√®re une valeur d'√©tat
- `setWState(name, value)` : Modifie l'√©tat sans re-render (pour l'initialisation)

#### R√©f√©rences DOM

- `setRef(name, value)` : Stocke une r√©f√©rence DOM
- `getRef(name)` : R√©cup√®re une r√©f√©rence DOM

#### Virtual DOM

- `createVElement(tag, props, children)` : Cr√©e un √©l√©ment virtuel

### Classe `Component`

#### M√©thodes √† surcharger

- `getVDom()` : **OBLIGATOIRE** - Retourne l'arbre virtuel √† afficher

#### Lifecycle

- `Mounting()` : Appel√© apr√®s le premier rendu du composant
- `UnMounting()` : Appel√© lors d'un changement de page/composant

#### Propri√©t√©s

- `this.framework` : R√©f√©rence vers l'instance du framework

### Cr√©ation d'√©l√©ments virtuels

#### Syntaxe de base

```js
this.framework.createVElement(tag, props, children);
```

- **tag** : `string` - Nom de la balise HTML
- **props** : `object` - Attributs et √©v√©nements
- **children** : `array` - Tableau d'enfants (√©l√©ments ou texte)

---

## üìö Exemples d√©taill√©s

### 1. Cr√©er un √©l√©ment simple

```js
// Cr√©er un paragraphe
this.framework.createVElement("p", {}, ["Bonjour le monde"]);

// Cr√©er un titre avec classe CSS
this.framework.createVElement("h1", { class: "title" }, ["Mon Titre"]);
```

### 2. Cr√©er un √©l√©ment avec attributs

```js
// Input avec attributs
this.framework.createVElement(
  "input",
  {
    type: "text",
    placeholder: "Tapez ici...",
    class: "form-control",
    id: "username",
  },
  []
);

// Lien avec attributs
this.framework.createVElement(
  "a",
  {
    href: "https://example.com",
    target: "_blank",
    class: "external-link",
  },
  ["Lien externe"]
);
```

### 3. Gestion d'√©v√©nements

```js
// Bouton avec √©v√©nement click
this.framework.createVElement(
  "button",
  {
    class: "btn btn-primary",
    onClick: () => {
      alert("Bouton cliqu√© !");
    },
  },
  ["Cliquez-moi"]
);

// Input avec √©v√©nement de saisie
this.framework.createVElement(
  "input",
  {
    type: "text",
    onInput: (e) => {
      console.log("Valeur:", e.target.value);
      this.framework.setState("inputValue", e.target.value);
    },
    onChange: (e) => {
      console.log("Changement confirm√©:", e.target.value);
    },
  },
  []
);

// Formulaire avec soumission
this.framework.createVElement(
  "form",
  {
    onSubmit: (e) => {
      e.preventDefault();
      console.log("Formulaire soumis");
    },
  },
  [
    // contenu du formulaire...
  ]
);
```

#### √âv√©nements support√©s

Tous les √©v√©nements HTML standard sont support√©s avec la syntaxe `on` + nom de l'√©v√©nement :

- `onClick`, `onMouseOver`, `onMouseOut`
- `onInput`, `onChange`, `onKeyPress`, `onKeyDown`, `onKeyUp`
- `onSubmit`, `onFocus`, `onBlur`
- `onLoad`, `onResize`, `onScroll`
- etc.

### 4. Imbriquer des √©l√©ments (Nesting)

```js
// Structure imbriqu√©e complexe
this.framework.createVElement("div", { class: "container" }, [
  this.framework.createVElement("header", { class: "header" }, [
    this.framework.createVElement("h1", {}, ["Mon Application"]),
    this.framework.createVElement("nav", {}, [
      this.framework.createVElement("ul", {}, [
        this.framework.createVElement("li", {}, [
          this.framework.createVElement("a", { href: "/" }, ["Accueil"]),
        ]),
        this.framework.createVElement("li", {}, [
          this.framework.createVElement("a", { href: "/about" }, ["√Ä propos"]),
        ]),
      ]),
    ]),
  ]),
  this.framework.createVElement("main", { class: "content" }, [
    this.framework.createVElement("p", {}, ["Contenu principal ici..."]),
  ]),
]);
```

### 5. Gestion de l'√©tat

```js
class CounterComponent extends Component {
  Mounting() {
    // Initialiser le state au montage du composant
    if (this.framework.getState("counter") === undefined) {
      this.framework.setWState("counter", 0); // setWState = pas de re-render
    }
  }

  getVDom() {
    const counter = this.framework.getState("counter") || 0;

    return this.framework.createVElement("div", {}, [
      this.framework.createVElement("h2", {}, [`Compteur: ${counter}`]),
      this.framework.createVElement(
        "button",
        {
          onClick: () => this.framework.setState("counter", counter + 1),
        },
        ["+1"]
      ),
      this.framework.createVElement(
        "button",
        {
          onClick: () => this.framework.setState("counter", counter - 1),
        },
        ["-1"]
      ),
    ]);
  }
}
```

### 6. Utilisation de r√©f√©rences DOM

```js
class InputFocusComponent extends Component {
  Mounting() {
    // Focus automatique sur l'input apr√®s le rendu
    setTimeout(() => {
      const input = this.framework.getRef("myInput");
      if (input) input.focus();
    }, 0);
  }

  getVDom() {
    return this.framework.createVElement("div", {}, [
      this.framework.createVElement("input", {
        ref: "myInput", // R√©f√©rence stock√©e automatiquement
        type: "text",
        placeholder: "Ce champ sera focus automatiquement",
      }),
      this.framework.createVElement(
        "button",
        {
          onClick: () => {
            const input = this.framework.getRef("myInput");
            input.select(); // S√©lectionner tout le texte
          },
        },
        ["S√©lectionner le texte"]
      ),
    ]);
  }
}
```

### 7. Routage avanc√©

```js
// Configuration des routes
const app = new Framework({
  currentUser: null,
  isLoggedIn: false,
});

class HomePage extends Component {
  getVDom() {
    return this.framework.createVElement("div", {}, [
      this.framework.createVElement("h1", {}, ["Page d'accueil"]),
      this.framework.createVElement(
        "button",
        {
          onClick: () => this.framework.navigateTo("/profile"),
        },
        ["Voir le profil"]
      ),
    ]);
  }
}

class ProfilePage extends Component {
  getVDom() {
    const user = this.framework.getState("currentUser");

    return this.framework.createVElement("div", {}, [
      this.framework.createVElement("h1", {}, ["Profil"]),
      user
        ? this.framework.createVElement("p", {}, [`Bonjour ${user.name}`])
        : this.framework.createVElement("p", {}, ["Veuillez vous connecter"]),
      this.framework.createVElement(
        "button",
        {
          onClick: () => this.framework.navigateTo("/"),
        },
        ["Retour √† l'accueil"]
      ),
    ]);
  }
}

// Enregistrement des routes
app.route("/", HomePage);
app.route("/profile", ProfilePage);

// D√©marrage
app.start();
```

### 8. Composant avec formulaire complet

```js
class ContactForm extends Component {
  Mounting() {
    // Initialiser les champs du formulaire
    this.framework.setWState("formData", {
      name: "",
      email: "",
      message: "",
    });
    this.framework.setWState("errors", {});
    this.framework.setWState("isSubmitting", false);
  }

  validateForm(data) {
    const errors = {};

    if (!data.name.trim()) errors.name = "Le nom est requis";
    if (!data.email.trim()) errors.email = "L'email est requis";
    else if (!data.email.includes("@")) errors.email = "Email invalide";
    if (!data.message.trim()) errors.message = "Le message est requis";

    return errors;
  }

  updateField(field, value) {
    const formData = this.framework.getState("formData");
    this.framework.setState("formData", {
      ...formData,
      [field]: value,
    });
  }

  submitForm() {
    const formData = this.framework.getState("formData");
    const errors = this.validateForm(formData);

    this.framework.setState("errors", errors);

    if (Object.keys(errors).length === 0) {
      this.framework.setState("isSubmitting", true);

      // Simulation d'envoi
      setTimeout(() => {
        alert("Formulaire envoy√© avec succ√®s !");
        this.framework.setState("isSubmitting", false);
        this.framework.setState("formData", {
          name: "",
          email: "",
          message: "",
        });
      }, 2000);
    }
  }

  getVDom() {
    const formData = this.framework.getState("formData") || {};
    const errors = this.framework.getState("errors") || {};
    const isSubmitting = this.framework.getState("isSubmitting");

    return this.framework.createVElement(
      "form",
      {
        onSubmit: (e) => {
          e.preventDefault();
          this.submitForm();
        },
      },
      [
        this.framework.createVElement("h2", {}, ["Formulaire de contact"]),

        // Champ nom
        this.framework.createVElement("div", {}, [
          this.framework.createVElement("label", {}, ["Nom:"]),
          this.framework.createVElement("input", {
            type: "text",
            value: formData.name || "",
            onInput: (e) => this.updateField("name", e.target.value),
            class: errors.name ? "error" : "",
          }),
          errors.name
            ? this.framework.createVElement("span", { class: "error-msg" }, [
                errors.name,
              ])
            : this.framework.createVElement("span", {}),
        ]),

        // Champ email
        this.framework.createVElement("div", {}, [
          this.framework.createVElement("label", {}, ["Email:"]),
          this.framework.createVElement("input", {
            type: "email",
            value: formData.email || "",
            onInput: (e) => this.updateField("email", e.target.value),
            class: errors.email ? "error" : "",
          }),
          errors.email
            ? this.framework.createVElement("span", { class: "error-msg" }, [
                errors.email,
              ])
            : this.framework.createVElement("span", {}),
        ]),

        // Champ message
        this.framework.createVElement("div", {}, [
          this.framework.createVElement("label", {}, ["Message:"]),
          this.framework.createVElement("textarea", {
            value: formData.message || "",
            onInput: (e) => this.updateField("message", e.target.value),
            class: errors.message ? "error" : "",
            rows: "4",
          }),
          errors.message
            ? this.framework.createVElement("span", { class: "error-msg" }, [
                errors.message,
              ])
            : this.framework.createVElement("span", {}),
        ]),

        // Bouton de soumission
        this.framework.createVElement(
          "button",
          {
            type: "submit",
            disabled: isSubmitting,
          },
          [isSubmitting ? "Envoi en cours..." : "Envoyer"]
        ),
      ]
    );
  }
}
```

---

## üí° Pourquoi ce fonctionnement ?

- **Virtual DOM** : Permet de manipuler l'UI comme un arbre JS, puis d'appliquer seulement les changements n√©cessaires au DOM r√©el (rapide et efficace).
- **Routage** : Synchronise l'URL et l'affichage, pour des SPA modernes.
- **State Management** : Centralise l'√©tat pour des applications pr√©visibles.
- **Event Handling** : Les √©v√©nements sont d√©clar√©s dans le Virtual DOM, nettoy√©s automatiquement lors des changements de page.

---

## üìù Exemples avanc√©s

---

## üí° Pourquoi ce fonctionnement ?

- **Virtual DOM** : Permet de manipuler l'UI comme un arbre JS, puis d'appliquer seulement les changements n√©cessaires au DOM r√©el (rapide et efficace).
- **Routage** : Synchronise l'URL et l'affichage, pour des SPA modernes avec support du bouton retour du navigateur.
- **State Management** : Centralise l'√©tat pour des applications pr√©visibles avec re-rendu automatique.
- **Event Handling** : Les √©v√©nements sont d√©clar√©s dans le Virtual DOM, nettoy√©s automatiquement lors des changements de page.
- **Composants** : Encapsulation et r√©utilisabilit√© du code avec lifecycle management.

---

## üöÄ Getting Started - Guide complet

### √âtape 1 : Structure de projet recommand√©e

```
mon-projet/
‚îú‚îÄ‚îÄ index.html
‚îú‚îÄ‚îÄ main.js
‚îú‚îÄ‚îÄ components/
‚îÇ   ‚îú‚îÄ‚îÄ Header.js
‚îÇ   ‚îú‚îÄ‚îÄ Navigation.js
‚îÇ   ‚îî‚îÄ‚îÄ Footer.js
‚îú‚îÄ‚îÄ pages/
‚îÇ   ‚îú‚îÄ‚îÄ HomePage.js
‚îÇ   ‚îú‚îÄ‚îÄ AboutPage.js
‚îÇ   ‚îî‚îÄ‚îÄ ContactPage.js
‚îú‚îÄ‚îÄ styles/
‚îÇ   ‚îî‚îÄ‚îÄ main.css
‚îî‚îÄ‚îÄ framework/         # Copi√© depuis ce repo
    ‚îú‚îÄ‚îÄ component.js
    ‚îú‚îÄ‚îÄ framwork.js
    ‚îî‚îÄ‚îÄ helpers.js
```

### √âtape 2 : HTML de base

```html
<!DOCTYPE html>
<html lang="fr">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Mon Application</title>
    <link rel="stylesheet" href="styles/main.css" />
  </head>
  <body>
    <div id="app">
      <!-- Le framework injectera le contenu ici -->
    </div>
    <script type="module" src="main.js"></script>
  </body>
</html>
```

### √âtape 3 : Application principale

```js
// main.js
import { Framework } from "./framework/framwork.js";
import { HomePage } from "./pages/HomePage.js";
import { AboutPage } from "./pages/AboutPage.js";
import { ContactPage } from "./pages/ContactPage.js";

// Initialiser avec un √©tat global
const app = new Framework({
  user: null,
  theme: "light",
  notifications: [],
});

// D√©finir les routes
app.route("/", HomePage);
app.route("/about", AboutPage);
app.route("/contact", ContactPage);

// D√©marrer l'application
app.start();

// Rendre accessible globalement pour le debug
window.app = app;
```

### √âtape 4 : Cr√©er un composant r√©utilisable

```js
// components/Header.js
import { Component } from "../framework/component.js";

export class Header extends Component {
  getVDom() {
    const user = this.framework.getState("user");

    return this.framework.createVElement("header", { class: "header" }, [
      this.framework.createVElement("div", { class: "container" }, [
        this.framework.createVElement("h1", { class: "logo" }, ["Mon App"]),
        this.framework.createVElement("nav", {}, [
          this.framework.createVElement(
            "a",
            {
              href: "/",
              onClick: (e) => {
                e.preventDefault();
                this.framework.navigateTo("/");
              },
            },
            ["Accueil"]
          ),
          this.framework.createVElement(
            "a",
            {
              href: "/about",
              onClick: (e) => {
                e.preventDefault();
                this.framework.navigateTo("/about");
              },
            },
            ["√Ä propos"]
          ),
        ]),
        user
          ? this.framework.createVElement("div", { class: "user-info" }, [
              `Bonjour ${user.name}`,
            ])
          : this.framework.createVElement(
              "button",
              {
                onClick: () => this.handleLogin(),
              },
              ["Se connecter"]
            ),
      ]),
    ]);
  }

  handleLogin() {
    // Simulation de connexion
    this.framework.setState("user", { name: "John Doe", id: 1 });
  }
}
```

### √âtape 5 : Cr√©er une page

```js
// pages/HomePage.js
import { Component } from "../framework/component.js";
import { Header } from "../components/Header.js";

export class HomePage extends Component {
  Mounting() {
    console.log("HomePage mont√©e");
    // Initialisation sp√©cifique √† cette page
  }

  UnMounting() {
    console.log("HomePage d√©mont√©e");
    // Nettoyage si n√©cessaire
  }

  getVDom() {
    return this.framework.createVElement("div", {}, [
      new Header(this.framework).getVDom(),
      this.framework.createVElement("main", { class: "main-content" }, [
        this.framework.createVElement("h2", {}, ["Bienvenue sur mon site"]),
        this.framework.createVElement("p", {}, [
          "Ceci est un exemple d'utilisation du mini-framework.",
        ]),
      ]),
    ]);
  }
}
```

---

## ÔøΩ Conseils et bonnes pratiques

### Performance

- Utilisez `setWState()` pour l'initialisation (pas de re-render)
- Utilisez `setState()` pour les modifications qui n√©cessitent un re-render
- √âvitez les objets trop profonds dans le state

### Organisation du code

- S√©parez vos composants en fichiers individuels
- Utilisez des composants r√©utilisables pour les √©l√©ments communs
- Centralisez la logique m√©tier dans le state global

### Debugging

- Le framework est accessible via `window.app` dans la console
- Utilisez `console.log()` dans les m√©thodes lifecycle pour tracer l'ex√©cution
- Inspectez l'√©tat avec `app.getState()` dans la console

### Gestion des erreurs

```js
class ErrorBoundary extends Component {
  getVDom() {
    try {
      // Votre code ici
      return this.framework.createVElement("div", {}, ["Contenu"]);
    } catch (error) {
      console.error("Erreur dans le composant:", error);
      return this.framework.createVElement("div", { class: "error" }, [
        "Une erreur est survenue",
      ]);
    }
  }
}
```

---

## üìù Exemples avanc√©s

### Application avec authentification

```js
class App extends Component {
  Mounting() {
    // V√©rifier l'authentification au d√©marrage
    const token = localStorage.getItem("authToken");
    if (token) {
      this.framework.setState("isLoggedIn", true);
      this.loadUserProfile();
    }
  }

  async loadUserProfile() {
    try {
      const response = await fetch("/api/user", {
        headers: {
          Authorization: `Bearer ${localStorage.getItem("authToken")}`,
        },
      });
      const user = await response.json();
      this.framework.setState("currentUser", user);
    } catch (error) {
      console.error("Erreur de chargement du profil:", error);
      this.framework.setState("isLoggedIn", false);
    }
  }

  getVDom() {
    const isLoggedIn = this.framework.getState("isLoggedIn");

    return this.framework.createVElement("div", { class: "app" }, [
      isLoggedIn
        ? new Dashboard(this.framework).getVDom()
        : new LoginForm(this.framework).getVDom(),
    ]);
  }
}
```

### Composant avec √©tat local et global

```js
class ShoppingCart extends Component {
  Mounting() {
    // √âtat local pour l'UI
    this.framework.setWState("cartVisible", false);
    // √âtat global pour les donn√©es
    if (!this.framework.getState("cartItems")) {
      this.framework.setWState("cartItems", []);
    }
  }

  addToCart(product) {
    const items = this.framework.getState("cartItems") || [];
    const existingItem = items.find((item) => item.id === product.id);

    if (existingItem) {
      this.framework.setState(
        "cartItems",
        items.map((item) =>
          item.id === product.id
            ? { ...item, quantity: item.quantity + 1 }
            : item
        )
      );
    } else {
      this.framework.setState("cartItems", [
        ...items,
        { ...product, quantity: 1 },
      ]);
    }
  }

  toggleCart() {
    const visible = this.framework.getState("cartVisible");
    this.framework.setState("cartVisible", !visible);
  }

  getVDom() {
    const cartItems = this.framework.getState("cartItems") || [];
    const cartVisible = this.framework.getState("cartVisible");
    const totalItems = cartItems.reduce((sum, item) => sum + item.quantity, 0);

    return this.framework.createVElement("div", { class: "shopping-cart" }, [
      this.framework.createVElement(
        "button",
        {
          class: "cart-toggle",
          onClick: () => this.toggleCart(),
        },
        [`Panier (${totalItems})`]
      ),

      cartVisible
        ? this.framework.createVElement("div", { class: "cart-dropdown" }, [
            ...cartItems.map((item) =>
              this.framework.createVElement("div", { class: "cart-item" }, [
                `${item.name} x ${item.quantity}`,
              ])
            ),
            cartItems.length === 0
              ? this.framework.createVElement("p", {}, ["Panier vide"])
              : this.framework.createVElement(
                  "button",
                  {
                    onClick: () => this.checkout(),
                  },
                  ["Commander"]
                ),
          ])
        : this.framework.createVElement("div", {}),
    ]);
  }

  checkout() {
    // Logique de commande...
    alert("Commande pass√©e !");
    this.framework.setState("cartItems", []);
    this.framework.setState("cartVisible", false);
  }
}
```
